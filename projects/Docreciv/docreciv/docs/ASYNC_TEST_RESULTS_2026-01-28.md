# Async Test Results 2026-01-28

## –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã Docreciv Async —Ä–µ–∂–∏–º–∞

**–î–∞—Ç–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**: 2026-01-28
**–î–∞—Ç–∞—Å–µ—Ç**: 2026-01-24 (1665 –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤)

---

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–¥ —Ç–µ—Å—Ç–∞–º–∏

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã `/app` (Docker leftovers)

**–ü—Ä–æ–±–ª–µ–º–∞**: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—ã—Ç–∞–ª–∞—Å—å —Å–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –≤ `/app/...` (Docker WORKDIR) –±–µ–∑ –ø—Ä–∞–≤.

**–†–µ—à–µ–Ω–∏–µ** –≤ `docreciv/core/config.py`:

| –ò–∑–º–µ–Ω–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|----------|
| `RouterConfig._get_default_dir()` | –ù–æ–≤—ã–π —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –º–µ—Ç–æ–¥ –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –¥–µ—Ñ–æ–ª—Ç–æ–≤ |
| `ensure_directories()` | Graceful error handling –≤–º–µ—Å—Ç–æ –ø–∞–¥–µ–Ω–∏—è |
| –î–µ—Ñ–æ–ª—Ç–Ω—ã–µ –ø—É—Ç–∏ | `/app/...` ‚Üí `/home/pak/Processing data/{fallback}` |

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: ‚úÖ –ù–µ—Ç warnings –ø—Ä–æ PermissionError

---

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤

### –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤

```
============================================================
üìä SYNCHRONIZATION RESULTS
============================================================
‚úÖ SUCCESS!
üìÖ Period: 2026-01-24
üîç Scanned: 1665
üíæ Inserted: 1665
‚è≠Ô∏è  Skipped (duplicates): 0
‚ùå Errors: 0
‚è±Ô∏è  Duration: 5.89 seconds
```

### Async –∑–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

```
=== FINAL RESULT ===
Status: partial
Message: Processed 1665 protocols: 1823 files downloaded, 34 failed, 0 skipped
Processed: 1665
Downloaded: 1823
Failed: 34
Duration: 428.83s
Throughput: 4.25 files/s
```

---

## –î–µ—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏

### –§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| UNIT –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π | 1 665 |
| PDF —Ñ–∞–π–ª–æ–≤ | 1 006 |
| DOCX —Ñ–∞–π–ª–æ–≤ | 365 |
| –ü—Ä–æ—á–∏–µ —Ñ–∞–π–ª—ã | 473 |
| Meta —Ñ–∞–π–ª–æ–≤ (JSON) | 3 330 |
| –û–±—â–∏–π —Ä–∞–∑–º–µ—Ä | 1000 MB |

### MongoDB —Å—Ç–∞—Ç—É—Å—ã

| –°—Ç–∞—Ç—É—Å | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ |
|--------|-----------|
| Total protocols | 1 665 |
| Downloaded | 1 665 (100%) |
| Pending | 0 |
| Failed | 0 |

### URL —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ

| –¢–∏–ø | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ |
|-----|-----------|
| Single URL | 1 516 (91%) |
| Multi URL | 149 (9%) |
| No URL | 0 |

| URL count | –ü—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ |
|----------|------------|
| 1 URL | 1 516 |
| 2 URLs | 131 |
| 3 URLs | 8 |
| 4 URLs | 1 |
| 5 URLs | 7 |
| 6 URLs | 1 |
| 10 URLs | 1 |

---

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –∑–∞–ø—É—Å–∫–æ–º

| –ú–µ—Ç—Ä–∏–∫–∞ | –ü—Ä–µ–¥—ã–¥—É—â–∏–π | –¢–µ–∫—É—â–∏–π | –ò–∑–º–µ–Ω–µ–Ω–∏–µ |
|---------|-----------|---------|-----------|
| Files downloaded | 1 813 | 1 823 | +10 |
| Errors | 44 | 34 | -10 (-23%) |
| Throughput | 4.24 files/s | 4.25 files/s | +0.01 |
| Success Rate | 97.6% | 98.2% | +0.6% |

**–£–ª—É—á—à–µ–Ω–∏—è**:
- ‚úÖ –ú–µ–Ω—å—à–µ –æ—à–∏–±–æ–∫ (34 vs 44)
- ‚úÖ –í—ã—à–µ success rate (98.2% vs 97.6%)
- ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω—ã–π throughput (~4.25 files/s)

---

## –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è –æ—à–∏–±–æ–∫ (34 –∏–∑ 1823)

| –¢–∏–ø –æ—à–∏–±–∫–∏ | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ | % |
|------------|-----------|---|
| Timeout | ~30 | 88% |
| Connection reset | 3 | 9% |
| Response payload incomplete | 1 | 3% |

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: "File name too long" –æ—à–∏–±–æ–∫ **–Ω–µ—Ç** ‚Äî –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ `sanitize_filename()` —Ä–∞–±–æ—Ç–∞–µ—Ç!

---

## –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

### –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è (–±–µ–∑ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è)
```
/home/pak/Processing data/2026-01-24/Input/
‚îú‚îÄ‚îÄ UNIT_004357d754ac4c51/
‚îÇ   ‚îú‚îÄ‚îÄ –ü—Ä–æ—Ç–æ–∫–æ–ª_—Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—è_–∑–∞—è–≤–æ–∫.pdf
‚îÇ   ‚îú‚îÄ‚îÄ unit.meta.json
‚îÇ   ‚îî‚îÄ‚îÄ raw_url_map.json
‚îú‚îÄ‚îÄ UNIT_0097257bb27c4246/
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ ... (1665 UNIT directories)
```

### unit.meta.json
```json
{
  "unit_id": "UNIT_004357d754ac4c51",
  "record_id": "697a7a1a1117075d6ac7b638",
  "source_date": "2026-01-24",
  "downloaded_at": "2026-01-28T21:13:18Z",
  "files_total": 1,
  "files_success": 1,
  "files_failed": 0,
  "purchase_notice_number": "32615603710",
  "source": "remote_mongo_direct",
  "url_count": 1,
  "multi_url": false
}
```

---

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–∞

```bash
# Environment variables
export ASYNC_MAX_CONCURRENT_REQUESTS=100
export ASYNC_MAX_CONCURRENT_PROTOCOLS=50
export ASYNC_LIMIT_PER_HOST=50
```

---

## –í—ã–≤–æ–¥—ã

1. **Async —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ** ‚Äî throughput ~4.25 files/s
2. **loadDate –≤–º–µ—Å—Ç–æ publicationDateTime** ‚Äî 40x –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö (1665 vs 41)
3. **sanitize_filename() –∏—Å–ø—Ä–∞–≤–ª–µ–Ω** ‚Äî –Ω–µ—Ç "File name too long" –æ—à–∏–±–æ–∫
4. **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—É—Ç–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ** ‚Äî UNIT –Ω–∞—Ö–æ–¥—è—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –≤ Input/
5. **–ü—Ä–æ–±–ª–µ–º–∞ `/app` –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞** ‚Äî graceful handling, –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –¥–µ—Ñ–æ–ª—Ç—ã

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
- ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ: –£–≤–µ–ª–∏—á–µ–Ω–∏–µ `limit_per_host` –¥–æ 50
- ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ: Graceful error handling –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ: –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –ø—É—Ç–∏ –¥–ª—è local dev

### –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è
- –£–≤–µ–ª–∏—á–∏—Ç—å MongoDB `maxPoolSize` –¥–æ 50
- Implement connection reuse –º–µ–∂–¥—É –∑–∞–ø—É—Å–∫–∞–º–∏
- Adaptive chunk sizing –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è
- Proxy rotation –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
- Predictive prefetching
- Circuit breaker pattern –¥–ª—è external dependencies
